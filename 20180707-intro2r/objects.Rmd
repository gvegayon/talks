---
title: 'Intro to R: A Workshop for HPCC Users (R language fundamentals)<br><img src="fig/trojan-rlogo.svg" width="250px">'
author: George G. Vega Yon<br>University of Southern California<br>Department of Preventive Medicine
date: July 7th, 2018
bibliography: intro2r.bib
---

# Getting Started

## Creating objects

*   In R you can create new objects by either using the assign operator (`<-`) or the equal sign `=`, for example, the following 2 are equivalent:
    
    ```{r assignment-1, collapse=TRUE, comment=""}
    a <- 1
    a =  1
    ```
    
    And it works for any type of data
    
    ```{r assignment-2, collapse=TRUE, comment=""}
    # Hey! here is a comment!.
    # Comments in R can be either at the begining of a line ...
    b <- "aloha" # ... or at the end of it!
    ```
    
    Historically the assign operator is the most common used.
    
----

## Data types 

*   The most basic data (object) type in R are vectors.
    
    ```{r}
    myvec1 <- vector("logical", 3)  # This is a logical vector of length 3
    myvec2 <- c(FALSE, TRUE, FALSE) # This is ALSO a logical vector of length 3
    myvec2
    length(myvec2)
    ```
      

*   Vectors can be of different modes: `logical`, `integer`, `numeric` (double), `complex`, `character`, and `raw`.
    (so one mode per vector!).
    
*   Vectors can also be lists, which is a VERY special type of object in R (most of its objects are lists!)
    ```{r}
    mylist1 <- vector("list", 2) # This is a list with 2 empty slots
    mylist2 <- list(NULL, NULL)  # This is ALSO a list with 2 empty slots
    mylist1
    ```

----

*   Moreover, lists elements can have names
    
    ```{r}
    mylist2 <- list(first = NULL, second = 1, third = c("a", "b", "c"))
    mylist2
    ```
    
    And we can access them as follows
    
    ```r
    # Getting the 3rd element of the list
    mylist2$third      # By name using the dollar sign
    mylist2[[3]]       # By position
    mylist2[["third"]] # By name using a string
    ```
    
    ```{r, echo=FALSE}
    mylist2[["third"]]
    ```


# Attributes and Structure

*   Objects in R have attributes (metadata)

    ```{r}
    # Here are the attributes of the iris dataset
    attributes(iris)    
    ```

----

*   You can take a general look at the structure of an R object with the `str()` function
    ```{r}
    # Let's take a look at the iris dataset, again
    str(iris)
    ```

# Missing values {.small}

R has different types of Missing values:

-   `NA`: no information, has length 1,
-   `NULL`: which has length 0,
-   `Inf`: Infinite, and
-   `NaN`: Not a Number
        
```{r missings, collapse=TRUE}
str(c(NA, 1L))        # Integers can have NAs
str(c(NaN, 1L, Inf))  # But not NaN or Inf (automatic coercion)
str(c(-Inf, 1, NULL, +Inf)) # And Nulls are... of length 0!
```

----

*   These have companion functions `is.na()`, `is.null`, `is.infinite` (or `is.finite()`, which covers NA, Inf, and NaN), and `is.nan`.
    
    ```{r testing-is}
    myvector <- c(NA, NaN, Inf)
    is.na(myvector)
    is.infinite(myvector)
    is.finite(myvector)
    is.nan(myvector)
    ```

# Other fundamental types

Other fundamental type of objects in R are

*   **Matrix**: A special class of array, are vectors with a `dim` attribute of length 2 (number of rows and number of columns).
    
    ```{r}
    mymat <- matrix(1:9, ncol=3) # A matrix with numbers 1 through 9 with 3 columns
    mymat
    str(mymat)
    ```
    
    R stores elements in column major-order. We can access matrices elements in the following way.
    
    ```{r, collapse=TRUE}
    mymat[1, 2] # The element in the (1, 2) location of the matrix
    mymat[4]    # The fourth element in the vector... which is (1, 2)
    ```
    
  
----

*   **Factors**: A set of *integer codes* with labels (levels).
    
    ```{r}
    myfactor <- factor(c("a", "a", "b", "xyz"))
    myfactor
    ```
    
    We treat factors as vectors.

----

*   **Data frames**: "A data frame is a list of variables of the same number of rows with unique row names, given class "data.frame"."
    
    ```{r}
    # Data frames can have multiple type objects, here, factor and numeric
    mydf <- data.frame(a_letter = c("a", "b", "c"), a_number = c(1, 2, 100))
    mydf
    str(mydf)
    ```
    
    We can access data frame objects as follow
    
    ```r
    mydf$a_letter      # Dollar sign
    mydf[[1]]          # Position of the column
    mydf[["a_letter"]] # Name of the column
    ```
    
    ```{r echo=FALSE}
    mydf[["a_letter"]]
    ```

---

# R has several type of objects, the most basic structures in R are:

1.  `vectors`,
2.  `matrix`,
3.  `list`,
4.  `data.frame`

Here is an example creating several of these (each line is enclosed with parenthesis so that R prints the resulting element):



```{r creating, collapse=TRUE}
a_vector     <- 1:9
another_vect <- c(1, 2, 3, 4, 5, 6, 7, 8, 9)
a_string_vec <- c("I", "like", "netdiffuseR")
a_matrix     <- matrix(a_vector, ncol = 3)
a_string_mat <- matrix(letters[1:9], ncol=3) # Matrices can be of strings too
another_mat  <- cbind(1:4, 11:14) # The `cbind` operator does "column bind"
another_mat2 <- rbind(1:4, 11:14) # The `rbind` operator does "row bind"
a_string_mat <- matrix(letters[1:9], ncol = 3)
a_list       <- list(a_vector, a_matrix)
another_list <- list(my_vec = a_vector, my_mat = a_matrix) # same but with names!
# Data frames can have multiple types of elements, it is a collection of lists
a_data_frame <- data.frame(x = 1:10, y = letters[1:10])
```
    
3.  Depending on the type of object, we can access to its components using indexing:
    ```{r indexing}
    a_vector[1:3] # First 3 elements
    a_string_vec[3] # Third element
    a_matrix[1:2, 1:2] # A sub matrix
    a_matrix[,3] # Third column
    a_matrix[3,] # Third row
    a_string_mat[1:6] # First 6 elements of the matrix. R stores matrices by column.
    
    # These three are equivalent
    another_list[[1]]
    another_list$my_vec
    another_list[["my_vec"]]
    
    # Data frames are just like lists
    a_data_frame[[1]]
    a_data_frame[,1]
    a_data_frame[["x"]]
    a_data_frame$x
    ```
    
4.  Control-flow statements
    ```{r control-flow}
    # The oldfashion forloop
    for (i in 1:10) {
      print(paste("I'm step", i, "/", 10))
    }
    
    # A nice ifelse
    
    for (i in 1:10) {
      
      if (i %% 2) # Modulus operand
        print(paste("I'm step", i, "/", 10, "(and I'm odd)"))
      else
        print(paste("I'm step", i, "/", 10, "(and I'm even)"))
      
    }
    
    # A while
    i <- 10
    while (i > 0) {
      print(paste("I'm step", i, "/", 10))
      i <- i - 1
    }
    ```

5.  R has a very nice set of pseudo random number generation functions. In general, distribution functions have the following name structure:
    a.  Random Number Generation: `r[name-of-the-distribution]`, e.g. `rnorm` for normal, `runif` for uniform.
    b.  Density function: `d[name-of-the-distribution]`, e.g. `dnorm` for normal, `dunif` for uniform.
    c.  Cumulative Distribution Function (CDF): `p[name-of-the-distribution]`, e.g. `pnorm` for normal, `punif` for uniform.
    d.  Inverse (quantile) function: `q[name-of-the-distribution]`, e.g. `qnorm` for the normal, `qunif` for the uniform.
    
    Here are some examples:
     
    ```{r random-numbers}
    # To ensure reproducibility
    set.seed(1231)
    
    # 100,000 Unif(0,1) numbers
    x <- runif(1e5)
    hist(x)
    
    # 100,000 N(0,1) numbers
    x <- rnorm(1e5)
    hist(x)
    
    # 100,000 N(10,25) numbers
    x <- rnorm(1e5, mean = 10, sd = 5)
    hist(x)
    
    # 100,000 Poisson(5) numbers
    x <- rpois(1e5, lambda = 5)
    hist(x)
    
    # 100,000 rexp(5) numbers
    x <- rexp(1e5, 5)
    hist(x)
    ```
    
    More distributions available at `??Distributions`.

For a nice intro to R, take a look at ["The Art of R Programming" by Norman Matloff](https://nostarch.com/artofr.htm). For more advanced users, take a look at ["Advanced R" by Hadley Wickham](http://adv-r.had.co.nz/).
    
    

